# Bối Cảnh Hiện Tại

- **Công việc đang tập trung:**
  - (Không có công việc đang tập trung)

- **Các thay đổi gần đây:**
  - **Viet hoa va sap xep lai trang quan tri admin:** Hoan thanh viet hoa toan bo trang quan tri Django admin voi tieu de "DBP Sports - Trung tam Quan tri", sap xep lai thu tu cac app theo logic nghiep vu (Giai dau → To chuc → Nguoi dung → Nha tai tro → Cua hang → Tin tuc), viet hoa ten hien thi tat ca cac models trong moi app, them emoji icons de phan biet cac model, va di chuyen action "Xoa" xuong cuoi cung trong dropdown actions de tranh nham lan.
  - **SEO Optimization - Structured Data Event:** Hoàn thành việc khắc phục các vấn đề Structured Data Event mà Google Analytics báo cáo cho dbpsports.com. Đã thêm đầy đủ các trường bắt buộc (offers, image, endDate, organizer, performer) vào các template quan trọng: tournament_detail.html, match_detail.html, home.html, active_list.html, archive.html. Sử dụng Schema.org Event với JSON-LD format để cải thiện SEO và hiển thị rich results trên Google Search.
  - **Thiết kế lại tab tổng quan:** Hoàn thành việc thiết kế lại tab tổng quan với các thẻ thông tin đồng bộ và đẹp mắt. Bao gồm Bio Card, Personal Info Card với role badges có icon đẹp mắt, Professional Summary Card, Achievements Card và Reviews Card. Sắp xếp lại thứ tự thẻ để thông tin cá nhân và chuyên môn hiển thị trước thành tích và đánh giá.
  - **Thêm QR code vào Stadium Profile:** Tích hợp mã QR thanh toán vào Stadium Profile Card trong tab chuyên môn với thiết kế center alignment, kích thước 120px và styling đẹp mắt với background và border.
  - **Thiết kế lại trang hồ sơ công khai:** Đã hoàn thành việc thiết kế lại giao diện trang hồ sơ công khai với phong cách theme giống các tab trong trang chi tiết giải đấu. Bao gồm modern navigation với gradient tím, backdrop blur, responsive design và đồng bộ desktop/mobile.
  - **Redesign tab chuyên môn:** Thiết kế lại hoàn toàn tab chuyên môn với các thẻ thông tin đồng bộ và đẹp mắt cho tất cả vai trò (Coach, Sponsor, Stadium, Commentator, Media, Referee). Mỗi thẻ có avatar với gradient, info grid, status badges, và responsive design.
  - Đã nâng cấp template trang Lưu trữ Giải đấu (archive.html) với giao diện hiện đại: gradient styling, responsive grid layout, animation effects, và màu sắc tím để phân biệt với trang giải đấu chính.
  - Đã cập nhật quy tắc update-memory-bank-agent để bỏ bước hỏi xác nhận.
  - Đã soát xét và cập nhật toàn bộ Memory Bank để phản ánh đúng thực tế dự án.
  - **Sửa lỗi cập nhật mã QR nhà tài trợ:** Khắc phục lỗi form không lưu được mã QR do conflict 2 model SponsorProfile. Đã migrate database và chuyển sang model mới từ users.models.
  - **Tối ưu UI hiển thị vai trò:** Làm gọn gàng hơn khu vực hiển thị thông tin Coach, Stadium, Sponsor với layout compact và CSS effects.
  - **Test va xac nhan he thong email hoan hao:** Da test toan bo 19 email templates va xac nhan he thong email backend hoat dong hoan hao. SMTP server mail.dbpsports.com:465 hoat dong on dinh, tat ca templates render dung va dep mat voi thiet ke purple gradient chuyen nghiep. Da don dep tat ca file test va template cu, workspace backend gio da sach se va chuyen nghiep.
  - **Hoan thanh tich hop payment_rejected.html:** Da them trang thai "Tu choi" vao dropdown payment_status trong admin, tao migration de cap nhat database, them admin action "reject_payments" de tu choi hang loat, cap nhat template team_detail.html de hien thi badge "Tu choi" va nut "Tai lai hoa don", va xoa tat ca debug statements. Email tu choi hoat dong hoan hao.
  - **Them nut dang ky ngay vao trang chi tiet giai dau:** Da them nut "Dang ky ngay" vao header trang chi tiet giai dau ben canh status badge, voi styling gradient tim dong bo voi thiet ke trang, responsive tren mobile, va chi hien thi khi giai dau dang mo dang ky va nguoi dung da dang nhap.
  - **Sua loi checkbox khuyen mai trong form thanh toan:** Da xac dinh va huong dan khac phuc loi checkbox khuyen mai khong hien thi cho cac doi thu 2, 3. Nguyen nhan la cac giai dau co shop_discount_percentage = 0, can cap nhat trong Django admin de hien thi checkbox.
  - **Cap nhat template tim huan luyen vien:** Da thiet ke lai template recruit_coach_list.html dong bo voi trang luu tru giai dau, bao gom gradient styling, coach cards hien dai, filter section dep mat, responsive design, va empty state chuyen nghiep.
  - **Toi uu trang thi truong chuyen nhuong:** Da cap nhat layout trang thi truong chuyen nhuong voi nut "Lich su" mau trang dat o goc duoi ben phai banner, xoa khoi tim kiem thua, di chuyen khoi tim kiem xuong duoi bang thong ke, va cap nhat template form moi voi layout 2 cot gon gang dong bo voi cac template form khac trong he thong.
  - **Nang cap trang live stream:** Hoan thanh nang cap trang live stream dong bo voi giao dien he thong voi gradient tim (#667eea → #764ba2), responsive design, animation effects, va hover states. Cap nhat layout header voi logo doi bong, can giua ten doi, di chuyen nut LIVE va Chia se ve tabbar, thiet ke lai phan tran dau sap dien ra voi layout 3 cot dep mat va de nhin hon. Them CSS variables, backdrop-filter, box-shadow, va loading states de tao ra trai nghiem nguoi dung chuyen nghiep.
  - **Nâng cấp giao diện hồ sơ đội bóng:** Hoàn thành việc nâng cấp giao diện hồ sơ đội bóng để có giao diện hiện đại giống với hồ sơ cầu thủ. Thiết kế lại banner header với gradient overlay và layout đẹp mắt, thêm modern profile navigation với 4 tabs (Tổng quan, Thành tích, Lịch sử thi đấu, Thống kê), thiết kế lại các professional cards với styling đồng nhất, và cải thiện responsive design với animation effects. Giao diện mới có gradient tím (#667eea → #764ba2), backdrop blur, và hover states chuyên nghiệp.
  - **Đồng bộ layout banner hồ sơ cầu thủ:** Hoàn thành việc cập nhật layout banner của hồ sơ cầu thủ để đồng bộ với hồ sơ đội bóng. Chuyển đổi từ layout cũ sang layout mới với 2 cột (trái/phải), đặt giá trị chuyển nhượng ở trên badges thông tin, và các nút hành động ở góc dưới bên phải. Thêm trường huấn luyện viên vào card thông tin đội bóng và tối ưu hóa responsive design cho cả hai loại hồ sơ.

- **Các quyết định gần đây:**
  - **Quyet dinh ve Admin Interface:** Quyet dinh viet hoa toan bo trang quan tri Django admin de de dang su dung hon cho nguoi dung Viet Nam. Sap xep lai thu tu cac app theo logic nghiep vu voi Giai dau uu tien cao nhat, sau do den To chuc, Nguoi dung, Nha tai tro, Cua hang, Tin tuc. Them emoji icons de phan biet cac model va di chuyen action "Xoa" xuong cuoi cung de tranh nham lan.
  - **Quyết định về SEO Structured Data:** Sử dụng Schema.org Event với JSON-LD format để khắc phục các vấn đề Structured Data mà Google Analytics báo cáo. Thêm đầy đủ các trường bắt buộc (offers, image, endDate, organizer, performer) với fallback values và dynamic eventStatus dựa trên trạng thái giải đấu. Sử dụng ItemList cho danh sách giải đấu và SportsEvent cho từng sự kiện cụ thể.
  - **Quyết định về Overview Tab Design:** Thiết kế lại tab tổng quan với các thẻ thông tin đồng bộ, sắp xếp lại thứ tự để thông tin cá nhân và chuyên môn hiển thị trước thành tích và đánh giá. Thêm role badges có icon đẹp mắt cho từng vai trò.
  - **Quyết định về QR Code Integration:** Tích hợp mã QR thanh toán vào Stadium Profile Card với thiết kế center alignment, kích thước 120px và styling đẹp mắt để người dùng dễ dàng quét và thanh toán.
  - **Quyết định về Profile Design:** Thiết kế lại trang hồ sơ công khai theo phong cách modern-tournament-nav với gradient tím (#667eea → #764ba2), backdrop blur, và responsive design để đồng bộ với trang chi tiết giải đấu.
  - **Quyết định về Professional Cards:** Sử dụng layout grid responsive (col-lg-6 col-xl-4) với các thẻ thông tin đồng bộ cho tất cả vai trò chuyên môn, mỗi thẻ có avatar với gradient, info grid, status badges và hover effects.
  - **Quyết định về Color Scheme:** Mỗi vai trò có màu sắc riêng biệt: Coach (xanh lá), Sponsor (vàng), Stadium (xanh dương), Commentator (đỏ), Media (tím), Referee (xám đen) để dễ phân biệt.
  - Quyết định sử dụng màu tím (purple/violet) cho trang Lưu trữ thay vì xanh dương để phân biệt rõ ràng với trang Giải đấu đang hoạt động.
  - Quyết định không yêu cầu xác nhận khi cập nhật Memory Bank để tăng tốc workflow.
  - **Quyết định về SponsorProfile:** Xóa model cũ trong sponsors.models, chuyển toàn bộ sang users.models.SponsorProfile để tránh conflict và có đầy đủ fields.
  - **Quyết định về UI:** Sử dụng layout compact cho profile cards với small text, ít padding, và rating badges để tiết kiệm không gian hiển thị.
  - **Quyết định về URL Reversing:** Để xử lý lỗi `NoReverseMatch`, quyết định sử dụng `user.email` làm giá trị thay thế (fallback) cho `user.username` khi tạo URL cho hồ sơ công khai (`public_profile`).
  - **Quyết định về Team Profile Design:** Thiết kế lại hồ sơ đội bóng theo phong cách hiện đại giống hồ sơ cầu thủ với banner header có gradient overlay, modern profile navigation với tabs, professional cards với styling đồng nhất, và responsive design với animation effects. Sử dụng gradient tím (#667eea → #764ba2) để đồng bộ với hệ thống.
  - **Quyết định về Profile Layout Synchronization:** Đồng bộ hóa layout banner giữa hồ sơ cầu thủ và hồ sơ đội bóng để tạo ra trải nghiệm người dùng nhất quán. Sử dụng layout 2 cột (trái/phải) với thông tin chính ở bên trái và nút hành động ở bên phải. Thêm trường huấn luyện viên vào hồ sơ đội bóng và tối ưu hóa responsive design.