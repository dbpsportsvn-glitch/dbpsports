{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}C√†i ƒë·∫∑t Shop Discount - {{ tournament.name }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="mb-1">
                        <i class="bi bi-shop me-2"></i>C√†i ƒë·∫∑t Shop Discount
                    </h2>
                    <p class="text-muted mb-0">{{ tournament.name }}</p>
                </div>
                <a href="{% url 'tournament_detail' pk=tournament.pk %}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left me-2"></i>Quay l·∫°i gi·∫£i ƒë·∫•u
                </a>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="row">
        <div class="col-lg-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-gear me-2"></i>C√†i ƒë·∫∑t Shop Discount
                    </h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle me-2"></i>
                        <strong>Th√¥ng tin:</strong> C√†i ƒë·∫∑t n√†y cho ph√©p c√°c ƒë·ªôi tham gia gi·∫£i ƒë·∫•u ƒë∆∞·ª£c gi·∫£m gi√° ph√≠ ƒëƒÉng k√Ω khi mua s·∫£n ph·∫©m t·ª´ shop.
                    </div>

                    <form method="post">
                        {% csrf_token %}
                        {{ form|crispy }}
                        
                        <div class="mt-4">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle me-2"></i>C·∫≠p nh·∫≠t c√†i ƒë·∫∑t
                            </button>
                            <a href="{% url 'tournament_detail' pk=tournament.pk %}" class="btn btn-outline-secondary ms-2">
                                <i class="bi bi-x-circle me-2"></i>H·ªßy
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Sidebar -->
        <div class="col-lg-4">
            <!-- Current Settings -->
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-info-circle me-2"></i>C√†i ƒë·∫∑t hi·ªán t·∫°i
                    </h6>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>Ph√≠ ƒëƒÉng k√Ω:</span>
                        <strong>{{ tournament.registration_fee|floatformat:0 }} VNƒê</strong>
                    </div>
                    <div class="d-flex justify-content-between mb-2">
                        <span>Shop discount:</span>
                        <strong class="{% if tournament.shop_discount_percentage > 0 %}text-success{% else %}text-muted{% endif %}">
                            {{ tournament.shop_discount_percentage }}%
                        </strong>
                    </div>
                    <hr>
                    <div class="d-flex justify-content-between">
                        <span>Tr·∫°ng th√°i:</span>
                        <span class="badge {% if tournament.shop_discount_percentage > 0 %}bg-success{% else %}bg-secondary{% endif %}">
                            {% if tournament.shop_discount_percentage > 0 %}ƒêang b·∫≠t{% else %}ƒêang t·∫Øt{% endif %}
                        </span>
                    </div>
                </div>
            </div>

            <!-- How it works -->
            <div class="card shadow-sm">
                <div class="card-header bg-success text-white">
                    <h6 class="mb-0">
                        <i class="bi bi-question-circle me-2"></i>C√°ch ho·∫°t ƒë·ªông
                    </h6>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <h6 class="text-success">üìä T√≠nh to√°n discount:</h6>
                        <small class="text-muted">
                            Discount = (Ti·ªÅn l√£i s·∫£n ph·∫©m √ó Ph·∫ßn trƒÉm) / 100<br>
                            <strong>V√≠ d·ª•:</strong> S·∫£n ph·∫©m l√£i 50,000ƒë, discount 10% = 5,000ƒë
                        </small>
                    </div>
                    
                    <div class="mb-3">
                        <h6 class="text-success">üéØ √Åp d·ª•ng:</h6>
                        <small class="text-muted">
                            ‚Ä¢ Ch·ªâ √°p d·ª•ng cho <strong>Main Shop</strong> v√† <strong>Shop BTC</strong><br>
                            ‚Ä¢ Gi·ªõi h·∫°n t·ªëi ƒëa b·∫±ng <strong>ph√≠ ƒëƒÉng k√Ω</strong><br>
                            ‚Ä¢ Ch·ªâ √°p d·ª•ng cho <strong>captain ƒë·ªôi</strong>
                        </small>
                    </div>

                    <div class="mb-3">
                        <h6 class="text-success">üí∞ L·ª£i √≠ch:</h6>
                        <small class="text-muted">
                            ‚Ä¢ Khuy·∫øn kh√≠ch ƒë·ªôi mua s·∫£n ph·∫©m<br>
                            ‚Ä¢ TƒÉng doanh thu cho BTC<br>
                            ‚Ä¢ Gi·∫£m chi ph√≠ ƒëƒÉng k√Ω cho ƒë·ªôi
                        </small>
                    </div>

                    {% if tournament.organization %}
                    <div class="alert alert-warning alert-sm">
                        <i class="bi bi-shop me-1"></i>
                        <small>
                            <strong>Shop BTC:</strong> C√°c ƒë·ªôi c√≥ th·ªÉ mua t·ª´ shop c·ªßa {{ tournament.organization.name }} ƒë·ªÉ ƒë∆∞·ª£c gi·∫£m gi√°.
                        </small>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
