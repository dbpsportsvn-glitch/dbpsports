{% extends 'organizations/organization_base.html' %}
{% load crispy_forms_tags %}

{% block title %}Chỉnh sửa: {{ tournament.name }}{% endblock %}

{% block sidebar %}
    {# Sửa lỗi nhỏ: Thêm context để menu được highlight chính xác #}
    {% include 'organizations/_manage_tournament_nav.html' with active_page='settings' %}
{% endblock %}

{% block management_content %}
<div class="card">
    {# --- BẮT ĐẦU KHỐI CODE ĐÃ SỬA --- #}
    <div class="card-header d-flex justify-content-between align-items-center flex-wrap gap-2">
        <h3 class="mb-0"><i class="bi bi-pencil-square"></i> Chỉnh sửa thông tin giải đấu</h3>
        
        {# Nút "Lưu" được đưa lên đây và liên kết với form bằng id #}
        <button type="submit" form="edit-tournament-form" class="btn btn-primary">
            <i class="bi bi-save-fill"></i> Lưu thay đổi
        </button>
    </div>
    {# --- KẾT THÚC KHỐI CODE ĐÃ SỬA --- #}

    <div class="card-body p-4">
        {# Thêm id="edit-tournament-form" vào thẻ form #}
        <form method="post" enctype="multipart/form-data" id="edit-tournament-form">
            {% csrf_token %}
            {{ form|crispy }}
            
            {# Nút lưu cũ ở cuối form đã được xóa bỏ #}
        </form>
    </div>
</div>
{% endblock %}