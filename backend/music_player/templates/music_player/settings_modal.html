{% load static %}
<!-- Settings Modal -->
<div id="settings-modal" class="settings-modal hidden">
    <div class="settings-modal-overlay"></div>
    <div class="settings-modal-content">
        <!-- Modal Header -->
        <div class="settings-modal-header">
            <h4 class="settings-modal-title">
                <i class="bi bi-gear-fill"></i>
                C√†i ƒê·∫∑t Music Player
            </h4>
            <button id="settings-close-btn" class="settings-close-btn">
                <i class="bi bi-x"></i>
            </button>
        </div>

        <!-- Tab Headers -->
        <div class="settings-tab-headers">
            <button class="settings-tab-header active" data-tab="settings">
                <i class="bi bi-sliders"></i>
                C√†i ƒê·∫∑t Player
            </button>
            <button class="settings-tab-header" data-tab="offline">
                <i class="bi bi-cloud-download"></i>
                Offline Playback
            </button>
            <button class="settings-tab-header" data-tab="mymusic">
                <i class="bi bi-music-note-list"></i>
                Nh·∫°c C·ªßa T√¥i
            </button>
            <button class="settings-tab-header" data-tab="myplaylists">
                <i class="bi bi-collection-play-fill"></i>
                Playlist C·ªßa T√¥i
            </button>
            <button class="settings-tab-header" data-tab="savedmusic">
                <i class="bi bi-heart-fill"></i>
                ƒê√£ L∆∞u
            </button>
        </div>

        <!-- Tab Contents -->
        <div class="settings-tab-contents">
            <!-- Tab 1: Player Settings -->
            <div class="settings-tab-content active" id="settings-tab-settings">
                <div class="settings-section">
                    <h5 class="settings-section-title">
                        <i class="bi bi-music-player"></i>
                        C√†i ƒê·∫∑t Ph√°t Nh·∫°c
                    </h5>
                    
                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-play-circle"></i>
                            T·ª± ƒë·ªông ph√°t
                        </div>
                        <label class="settings-toggle">
                            <input type="checkbox" id="setting-autoplay" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>

                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-volume-up"></i>
                            √Çm l∆∞·ª£ng m·∫∑c ƒë·ªãnh
                            <span class="settings-value" id="volume-value">70%</span>
                        </div>
                        <input type="range" class="settings-slider" id="setting-volume" min="0" max="100" value="70">
                    </div>

                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-arrow-repeat"></i>
                            Ch·∫ø ƒë·ªô l·∫∑p
                        </div>
                        <select class="settings-select" id="setting-repeat">
                            <option value="none">Kh√¥ng l·∫∑p</option>
                            <option value="one">L·∫∑p m·ªôt b√†i</option>
                            <option value="all" selected>L·∫∑p t·∫•t c·∫£</option>
                        </select>
                    </div>

                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-shuffle"></i>
                            Ph√°t ng·∫´u nhi√™n
                        </div>
                        <label class="settings-toggle">
                            <input type="checkbox" id="setting-shuffle">
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>

                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-battery"></i>
                            Ch·∫ø ƒë·ªô m√°y y·∫øu
                        </div>
                        <label class="settings-toggle">
                            <input type="checkbox" id="setting-lowpower">
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>

                    <div class="settings-row">
                        <div class="settings-label">
                            <i class="bi bi-cloud-download"></i>
                            T·ª± ƒë·ªông cache nh·∫°c khi nghe
                        </div>
                        <label class="settings-toggle">
                            <input type="checkbox" id="setting-autocache" checked>
                            <span class="settings-toggle-slider"></span>
                        </label>
                    </div>

                    <button class="settings-save-btn" id="save-settings-btn">
                        <i class="bi bi-check-circle"></i>
                        L∆∞u C√†i ƒê·∫∑t
                    </button>
                </div>

                <!-- Version Info -->
                <div style="margin-top: 24px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 24px;">
                    <div style="background: rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.2); border-radius: 8px; padding: 12px;">
                        <div style="display: flex; gap: 12px; align-items: center; justify-content: space-between;">
                            <div style="flex: 1;">
                                <div style="font-size: 12px; color: rgba(255,255,255,0.6); margin-bottom: 4px;">
                                    <i class="bi bi-info-circle"></i> Phi√™n b·∫£n ·ª©ng d·ª•ng
                                </div>
                                <div style="font-size: 14px; font-weight: 600; color: rgba(255,255,255,0.95);">
                                    Music Player v1.5.7
                                </div>
                                <div style="font-size: 11px; color: rgba(255,255,255,0.5); margin-top: 4px;">
                                    ƒê∆∞·ª£c c·∫≠p nh·∫≠t v√†o: 27/10/2025
                                </div>
                                <div style="font-size: 10px; color: rgba(255,255,255,0.4); margin-top: 6px; font-style: italic;">
                                    ¬© 2025 DBP Sports. All rights reserved.
                                </div>
                            </div>
                            <div style="font-size: 48px; color: rgba(255,255,255,0.9); padding-right: 8px;">
                                <i class="bi bi-music-note-beamed" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 2: Offline Playback -->
            <div class="settings-tab-content" id="settings-tab-offline">
                <div class="settings-section">
                    <h5 class="settings-section-title">
                        <i class="bi bi-cloud-download"></i>
                        Offline Playback
                    </h5>
                    
                    <div class="offline-info-box" style="background: rgba(17, 153, 142, 0.1); border: 1px solid rgba(17, 153, 142, 0.3); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="bi bi-info-circle-fill" style="color: #11998e; font-size: 24px; flex-shrink: 0;"></i>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 4px; color: rgba(255,255,255,0.95);">
                                    üéµ Nghe nh·∫°c kh√¥ng c·∫ßn Internet!
                                </div>
                                <div style="font-size: 13px; color: rgba(255,255,255,0.8); line-height: 1.5;">
                                    C√°c b√†i h√°t b·∫°n nghe s·∫Ω t·ª± ƒë·ªông cache l·∫°i ƒë·ªÉ nghe offline. Kh√¥ng c·∫ßn download, kh√¥ng t·ªën dung l∆∞·ª£ng server!
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Cache Status -->
                    <div id="offline-cache-status" class="offline-cache-status">
                        <!-- Will be populated by JavaScript -->
                        <div style="text-align: center; color: rgba(255,255,255,0.6); padding: 20px;">
                            <i class="bi bi-cloud-download" style="font-size: 32px; margin-bottom: 8px;"></i>
                            <p style="font-size: 13px; margin: 0;">ƒêang ki·ªÉm tra cache...</p>
                        </div>
                    </div>

                    <!-- Cached Tracks List -->
                    <div id="offline-cached-tracks" class="offline-cached-tracks" style="margin-top: 16px;">
                        <!-- Will be populated by JavaScript -->
                    </div>

                    <!-- Cache Actions -->
                    <div class="offline-actions" style="display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap;">
                        <button class="offline-action-btn" id="cleanup-cache-btn" style="flex: 1; min-width: 120px; padding: 12px; background: rgba(245, 158, 11, 0.15); border: 1px solid rgba(245, 158, 11, 0.3); border-radius: 8px; color: #f59e0b; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i class="bi bi-broom"></i>
                            D·ªçn D·∫πp
                        </button>
                        <button class="offline-action-btn" id="clear-cache-btn" style="flex: 1; min-width: 120px; padding: 12px; background: rgba(239, 68, 68, 0.15); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; color: #ef4444; font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i class="bi bi-trash"></i>
                            X√≥a To√†n B·ªô
                        </button>
                        <button class="offline-action-btn" id="refresh-cache-btn" style="flex: 1; min-width: 120px; padding: 12px; background: rgba(255, 255, 255, 0.1); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: rgba(255, 255, 255, 0.9); font-weight: 600; cursor: pointer; transition: all 0.2s ease; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i class="bi bi-arrow-clockwise"></i>
                            L√†m M·ªõi
                        </button>
                    </div>

                    <!-- PWA Install Button (hidden by default, shown when available) -->
                    <div id="pwa-install-section" style="margin-top: 16px; display: none;">
                        <button id="pwa-install-btn" class="pwa-install-btn" style="width: 100%; padding: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border: none; border-radius: 12px; color: white; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 12px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
                            <i class="bi bi-download" style="font-size: 20px;"></i>
                            <span>C√†i ƒê·∫∑t ·ª®ng D·ª•ng (PWA)</span>
                        </button>
                        <p style="text-align: center; font-size: 11px; color: rgba(255,255,255,0.6); margin-top: 8px; margin-bottom: 0;">
                            <i class="bi bi-info-circle"></i> C√†i app l√™n m√°y ƒë·ªÉ tr·∫£i nghi·ªám nh∆∞ ·ª©ng d·ª•ng native
                        </p>
                    </div>

                    <!-- iOS Install Instructions -->
                    <div id="ios-install-instructions" style="display: none; margin-top: 16px; background: rgba(59, 130, 246, 0.1); border: 1px solid rgba(59, 130, 246, 0.3); border-radius: 12px; padding: 16px;">
                        <div style="display: flex; gap: 12px; align-items: start;">
                            <i class="bi bi-apple" style="color: #3b82f6; font-size: 24px; flex-shrink: 0;"></i>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; margin-bottom: 8px; color: rgba(255,255,255,0.95); font-size: 14px;">
                                    üì± C√†i ƒë·∫∑t tr√™n iOS/iPhone
                                </div>
                                <ol style="font-size: 12px; color: rgba(255,255,255,0.8); line-height: 1.6; margin: 0; padding-left: 20px;">
                                    <li>Nh·∫•n n√∫t <strong>Chia s·∫ª</strong> <i class="bi bi-box-arrow-up"></i> (·ªü thanh menu d∆∞·ªõi)</li>
                                    <li>Ch·ªçn <strong>"Th√™m v√†o M√†n h√¨nh ch√≠nh"</strong></li>
                                    <li>Nh·∫•n <strong>"Th√™m"</strong> ƒë·ªÉ ho√†n t·∫•t</li>
                                </ol>
                            </div>
                        </div>
                    </div>

                    <!-- Detection Script -->
                    <script>
                    (function() {
                        // Detect iOS
                        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
                        const isInStandaloneMode = window.matchMedia('(display-mode: standalone)').matches || 
                                                   window.navigator.standalone === true;
                        
                        if (isIOS && !isInStandaloneMode) {
                            // Show iOS instructions
                            const iosInstructions = document.getElementById('ios-install-instructions');
                            if (iosInstructions) {
                                iosInstructions.style.display = 'block';
                            }
                        }
                    })();
                    </script>

                    <!-- How it works -->
                    <details style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 16px;">
                        <summary style="cursor: pointer; font-size: 13px; color: rgba(255,255,255,0.8); font-weight: 500; user-select: none;">
                            <i class="bi bi-question-circle"></i> C√°ch ho·∫°t ƒë·ªông?
                        </summary>
                        <div style="margin-top: 12px; font-size: 12px; color: rgba(255,255,255,0.7); line-height: 1.6; padding-left: 8px;">
                            <ul style="margin: 8px 0; padding-left: 20px;">
                                <li style="margin-bottom: 8px;">‚úÖ <strong>T·ª± ƒë·ªông cache:</strong> Khi b·∫°n nghe nh·∫°c, b√†i h√°t s·∫Ω t·ª± ƒë·ªông l∆∞u v√†o cache</li>
                                <li style="margin-bottom: 8px;">‚úÖ <strong>Offline playback:</strong> Nghe l·∫°i ƒë∆∞·ª£c khi kh√¥ng c√≥ Internet</li>
                                <li style="margin-bottom: 8px;">‚úÖ <strong>Kh√¥ng t·ªën quota:</strong> Cache ·ªü tr√¨nh duy·ªát, kh√¥ng t√≠nh v√†o 369MB upload</li>
                                <li style="margin-bottom: 8px;">‚úÖ <strong>An to√†n:</strong> Kh√¥ng th·ªÉ download file ra ngo√†i app</li>
                                <li style="margin-bottom: 8px;">‚ö†Ô∏è <strong>T·ª± ƒë·ªông x√≥a:</strong> Browser c√≥ th·ªÉ x√≥a cache khi ƒë·∫ßy ·ªï ƒëƒ©a</li>
                            </ul>
                        </div>
                    </details>
                </div>
            </div>

            <!-- Tab 3: My Music -->
            <div class="settings-tab-content" id="settings-tab-mymusic">
                <div class="settings-section">
                    <!-- Upload Quota -->
                    <div class="upload-quota-section">
                        <h5 class="settings-section-title">
                            <i class="bi bi-cloud-upload"></i>
                            B·ªô Nh·ªõ Upload
                        </h5>
                        <div class="quota-info">
                            <div class="quota-text">
                                <span id="quota-used">0</span> / <span id="quota-total">369</span> MB
                                (<span id="quota-remaining">369</span> MB c√≤n l·∫°i)
                            </div>
                            <div class="quota-text-small" style="color: rgba(255,255,255,0.7); font-size: 12px; margin-top: 4px;">
                                <span id="tracks-count">0</span> b√†i h√°t
                            </div>
                            <div class="quota-bar">
                                <div class="quota-fill" id="quota-fill" style="width: 0%"></div>
                            </div>
                            <div class="quota-contact-hint" style="color: rgba(255,255,255,0.6); font-size: 11px; margin-top: 8px; font-style: italic;">
                                <i class="bi bi-info-circle"></i>
                                C·∫ßn th√™m dung l∆∞·ª£ng? Li√™n h·ªá Admin ƒë·ªÉ ƒë∆∞·ª£c h·ªó tr·ª£!
                            </div>
                        </div>
                    </div>

                    <!-- Upload Button -->
                    <div class="upload-section">
                        <!-- ‚úÖ Playlist Selection Dropdown -->
                        <div class="upload-playlist-selector">
                            <label>
                                <i class="bi bi-list-ul"></i> Ch·ªçn Playlist (T√πy ch·ªçn)
                            </label>
                            <select id="upload-playlist-select" class="form-select">
                                <option value="">-- Kh√¥ng th√™m v√†o playlist --</option>
                                <!-- Playlists will be loaded here -->
                            </select>
                        </div>
                        
                        <div class="upload-buttons">
                            <button class="upload-btn" id="upload-btn">
                                <i class="bi bi-cloud-arrow-up"></i>
                                Upload Nh·∫°c
                            </button>
                            <button class="youtube-import-btn" id="youtube-import-btn">
                                <i class="bi bi-youtube"></i>
                                Import t·ª´ YouTube
                            </button>
                        </div>
                        <input type="file" id="file-input" accept=".mp3,.m4a,.aac,.ogg,.wav" multiple style="display: none;">
                        <p class="upload-hint">
                            <i class="bi bi-info-circle"></i>
                            Upload: MP3, M4A, AAC, OGG, WAV. Import YouTube: Video/Playlist ‚Üí Audio MP3. T·ªëi ƒëa theo quota c√≤n l·∫°i.
                        </p>
                    </div>

                    <!-- My Tracks List -->
                    <div class="my-tracks-section">
                        <div class="tracks-header">
                            <h5 class="settings-section-title">
                                <i class="bi bi-music-note-beamed"></i>
                                Danh S√°ch B√†i H√°t
                            </h5>
                            <button class="delete-all-tracks-btn" id="delete-all-tracks-btn">
                                <i class="bi bi-trash"></i>
                                X√≥a T·∫•t C·∫£
                            </button>
                        </div>
                        <div id="my-tracks-list" class="my-tracks-list">
                            <div class="empty-state">
                                <i class="bi bi-music-note"></i>
                                <p>Ch∆∞a c√≥ b√†i h√°t n√†o. H√£y upload nh·∫°c c·ªßa b·∫°n!</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 4: My Playlists -->
            <div class="settings-tab-content" id="settings-tab-myplaylists">
                <div class="settings-section">
                    <div class="playlist-header">
                        <h5 class="settings-section-title">
                            <i class="bi bi-collection-play"></i>
                            Playlist C·ªßa B·∫°n
                        </h5>
                        <button class="create-playlist-btn" id="create-playlist-btn">
                            <i class="bi bi-plus-circle"></i>
                            T·∫°o Playlist M·ªõi
                        </button>
                    </div>

                    <div id="my-playlists-list" class="my-playlists-list">
                        <div class="empty-state">
                            <i class="bi bi-collection-play"></i>
                            <p>Ch∆∞a c√≥ playlist n√†o. T·∫°o playlist ƒë·∫ßu ti√™n!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 5: Saved Music -->
            <div class="settings-tab-content" id="settings-tab-savedmusic">
                <div class="settings-section">
                    <h5 class="settings-section-title">
                        <i class="bi bi-heart-fill"></i>
                        B√†i H√°t ƒê√£ L∆∞u
                    </h5>
                    
                    <div id="saved-tracks-list" class="saved-tracks-list">
                        <div class="empty-state">
                            <i class="bi bi-heart"></i>
                            <p>Ch∆∞a c√≥ b√†i h√°t n√†o ƒë∆∞·ª£c l∆∞u. H√£y l∆∞u b√†i h√°t y√™u th√≠ch!</p>
                            <p style="font-size: 12px; color: rgba(255,255,255,0.6); margin-top: 8px;">
                                üí° Nh·∫•n v√†o icon <i class="bi bi-heart"></i> tr√™n b√†i h√°t ƒë·ªÉ l∆∞u v√†o danh s√°ch y√™u th√≠ch
                            </p>
                        </div>
                    </div>
                </div>

                <div class="settings-section" style="margin-top: 24px;">
                    <h5 class="settings-section-title">
                        <i class="bi bi-collection-play-fill"></i>
                        Playlist ƒê√£ L∆∞u
                    </h5>
                    
                    <div id="saved-playlists-list" class="saved-playlists-list">
                        <div class="empty-state">
                            <i class="bi bi-collection-play"></i>
                            <p>Ch∆∞a c√≥ playlist n√†o ƒë∆∞·ª£c l∆∞u. H√£y l∆∞u playlist y√™u th√≠ch!</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ‚úÖ Save Track Options Modal -->
<div class="modal fade music-player-modal" id="saveTrackOptionsModal" tabindex="-1" aria-labelledby="saveTrackOptionsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content music-player-modal-content">
            <div class="modal-header music-player-modal-header">
                <h5 class="modal-title" id="saveTrackOptionsModalLabel">
                    <i class="bi bi-heart-fill"></i>
                    L∆∞u B√†i H√°t
                </h5>
                <button type="button" class="btn-close music-player-btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="save-track-options">
                    <div class="mb-3">
                        <label class="form-label">Ch·ªçn c√°ch l∆∞u b√†i h√°t:</label>
                    </div>
                    
                    <!-- Option 1: Auto Create -->
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="playlistAction" id="autoCreate" value="auto_create" checked>
                        <label class="form-check-label" for="autoCreate">
                            <div class="option-content">
                                <div class="option-title">
                                    <i class="bi bi-magic text-primary"></i>
                                    T·ª± ƒë·ªông t·∫°o playlist "B√†i H√°t ƒê√£ L∆∞u"
                                </div>
                                <div class="option-description">
                                    T·ª± ƒë·ªông t·∫°o playlist v√† chia s·∫ª ra global ƒë·ªÉ m·ªçi ng∆∞·ªùi c√≥ th·ªÉ nghe
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <!-- Option 2: Add to Existing -->
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="playlistAction" id="addToExisting" value="add_to_existing">
                        <label class="form-check-label" for="addToExisting">
                            <div class="option-content">
                                <div class="option-title">
                                    <i class="bi bi-plus-circle text-success"></i>
                                    Th√™m v√†o playlist c√≥ s·∫µn
                                </div>
                                <div class="option-description">
                                    Ch·ªçn playlist hi·ªán c√≥ ƒë·ªÉ th√™m b√†i h√°t v√†o
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <!-- Existing Playlist Selector -->
                    <div id="existingPlaylistSelector" class="mb-3" style="display: none;">
                        <label class="form-label">Ch·ªçn playlist:</label>
                        <select class="form-select" id="existingPlaylistSelect">
                            <option value="">Ch·ªçn playlist...</option>
                        </select>
                    </div>
                    
                    <!-- Option 3: Create New -->
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="playlistAction" id="createNew" value="create_new">
                        <label class="form-check-label" for="createNew">
                            <div class="option-content">
                                <div class="option-title">
                                    <i class="bi bi-plus-square text-info"></i>
                                    T·∫°o playlist m·ªõi
                                </div>
                                <div class="option-description">
                                    T·∫°o playlist m·ªõi v·ªõi t√™n t√πy ch·ªânh
                                </div>
                            </div>
                        </label>
                    </div>
                    
                    <!-- New Playlist Name Input -->
                    <div id="newPlaylistNameInput" class="mb-3" style="display: none;">
                        <label class="form-label">T√™n playlist m·ªõi:</label>
                        <input type="text" class="form-control" id="newPlaylistName" placeholder="Nh·∫≠p t√™n playlist...">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                <button type="button" class="btn btn-danger" id="confirmSaveTrack">
                    <i class="bi bi-heart-fill"></i>
                    L∆∞u B√†i H√°t
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Create Playlist Modal -->
<div id="create-playlist-modal" class="create-playlist-modal hidden">
    <div class="playlist-modal-overlay"></div>
    <div class="playlist-modal-content">
        <div class="playlist-modal-header">
            <h4><i class="bi bi-plus-circle"></i> T·∫°o Playlist M·ªõi</h4>
            <button class="playlist-modal-close" id="playlist-modal-close">
                <i class="bi bi-x"></i>
            </button>
        </div>
        <form id="create-playlist-form" enctype="multipart/form-data">
            <div class="form-group">
                <label>T√™n Playlist <span style="color: #ff6b6b;">*</span></label>
                <input type="text" id="playlist-name" name="name" class="form-input" placeholder="V√≠ d·ª•: Nh·∫°c y√™u th√≠ch" required>
            </div>
            <div class="form-group">
                <label>M√¥ t·∫£</label>
                <textarea id="playlist-description" name="description" class="form-textarea" placeholder="M√¥ t·∫£ v·ªÅ playlist..." rows="3"></textarea>
            </div>
            <div class="form-group">
                <label>·∫¢nh b√¨a Playlist</label>
                <div class="cover-upload-area">
                    <input type="file" id="playlist-cover" name="cover_image" accept="image/*" style="display: none;">
                    <div class="cover-preview" id="cover-preview">
                        <i class="bi bi-image" style="font-size: 48px; color: rgba(255,255,255,0.5);"></i>
                        <p style="margin-top: 8px; color: rgba(255,255,255,0.7);">Click ƒë·ªÉ ch·ªçn ·∫£nh</p>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label>
                    <input type="checkbox" id="playlist-public" name="is_public" style="margin-right: 8px;">
                    C√¥ng khai playlist
                </label>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-secondary" id="cancel-playlist-btn">H·ªßy</button>
                <button type="submit" class="btn-primary">
                    <i class="bi bi-check-circle"></i> T·∫°o Playlist
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Upload Progress Overlay -->
<div id="upload-progress-overlay" class="upload-progress-overlay hidden">
    <div class="upload-progress-content">
        <h4>
            <i class="bi bi-cloud-upload"></i>
            ƒêang Upload...
        </h4>
        <div class="upload-progress-list" id="upload-progress-list">
            <!-- Progress items will be added here -->
        </div>
    </div>
</div>

<!-- YouTube Import Modal -->
<div id="youtube-import-modal" class="youtube-import-modal hidden" style="display: none !important; visibility: hidden !important;">
    <div class="youtube-import-overlay"></div>
    <div class="youtube-import-content">
        <div class="keyboard-shortcut">
            <i class="bi bi-keyboard"></i>
            <kbd>Ctrl</kbd> + <kbd>I</kbd>
        </div>
        <div class="youtube-import-header">
            <h4 class="youtube-import-title">
                <i class="bi bi-youtube"></i>
                Import t·ª´ YouTube
            </h4>
            <button id="youtube-import-close-btn" class="youtube-import-close-btn">
                <i class="bi bi-x"></i>
            </button>
        </div>
        
        <div class="youtube-import-body">
            <!-- URL Input -->
            <div class="form-group">
                <label>
                    <i class="bi bi-link-45deg"></i>
                    YouTube URL <span style="color: #ff6b6b;">*</span>
                </label>
                <div class="url-input-container">
                    <input type="url" id="youtube-url" class="form-input" placeholder="https://www.youtube.com/watch?v=... ho·∫∑c https://www.youtube.com/playlist?list=..." required>
                    <button type="button" id="paste-url-btn" class="paste-btn" title="D√°n URL t·ª´ clipboard">
                        <i class="bi bi-clipboard"></i>
                    </button>
                </div>
                <div class="form-hint">
                    <i class="bi bi-info-circle"></i>
                    H·ªó tr·ª£: Video ƒë∆°n l·∫ª, Playlist, Channel videos
                </div>
            </div>
            
            <!-- Playlist Selection -->
            <div class="form-group">
                <label>
                    <i class="bi bi-list-ul"></i>
                    Th√™m v√†o Playlist (T√πy ch·ªçn)
                </label>
                <select id="youtube-playlist-select" class="form-select">
                    <option value="">-- Kh√¥ng th√™m v√†o playlist --</option>
                    <!-- Playlists will be loaded here -->
                </select>
            </div>
            
            <!-- Preview Section -->
            <div id="youtube-preview" class="youtube-preview hidden">
                <div class="preview-header">
                    <h5>
                        <i class="bi bi-eye"></i>
                        Xem Tr∆∞·ªõc
                    </h5>
                </div>
                <div id="youtube-preview-content">
                    <!-- Preview content will be loaded here -->
                </div>
            </div>
            
            <!-- Import Progress -->
            <div id="youtube-import-progress" class="youtube-import-progress hidden">
                <div class="progress-header">
                    <h5>
                        <i class="bi bi-download"></i>
                        ƒêang Import...
                    </h5>
                    <button type="button" id="cancel-import-btn" class="cancel-btn">
                        <i class="bi bi-x-circle"></i> H·ªßy Import
                    </button>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="youtube-progress-fill"></div>
                </div>
                <div class="progress-text" id="youtube-progress-text">ƒêang chu·∫©n b·ªã...</div>
                <div class="progress-details" id="youtube-progress-details"></div>
            </div>
            
                   <!-- Options -->
                   <div class="form-group">
                       <label>
                           <i class="bi bi-gear"></i>
                           T√πy ch·ªçn Import
                       </label>
                       <div class="youtube-options">
                           <label class="option-checkbox">
                               <input type="checkbox" id="extract-audio-only" checked>
                               <span class="checkmark"></span>
                               Ch·ªâ l·∫•y √¢m thanh (khuy·∫øn ngh·ªã)
                           </label>
                           <div class="option-hint">
                               <i class="bi bi-info-circle"></i>
                               Ch·ªâ download audio MP3, ti·∫øt ki·ªám dung l∆∞·ª£ng v√† th·ªùi gian
                           </div>
                           
                           <label class="option-checkbox">
                               <input type="checkbox" id="import-playlist">
                               <span class="checkmark"></span>
                               Import c·∫£ playlist
                           </label>
                           <div class="option-hint">
                               <i class="bi bi-info-circle"></i>
                               N·∫øu b·ªè tick: ch·ªâ import video ƒë∆°n l·∫ª, kh√¥ng import c·∫£ playlist
                           </div>
                       </div>
                   </div>
            
            <!-- Cookie Management -->
            <div class="form-group">
                <label>
                    <i class="bi bi-shield-check"></i>
                    Cookie Management (T√πy ch·ªçn)
                </label>
                <div class="cookie-management">
                    <div class="cookie-status" id="cookie-status">
                        <div class="cookie-status-text">
                            <i class="bi bi-info-circle"></i>
                            <span>ƒêang ki·ªÉm tra tr·∫°ng th√°i cookie...</span>
                        </div>
                    </div>
                    <div class="cookie-actions">
                        <input type="file" id="cookie-file-input" accept=".txt" style="display: none;">
                        <button type="button" id="upload-cookie-btn" class="btn-secondary">
                            <i class="bi bi-upload"></i> Upload Cookie
                        </button>
                        <button type="button" id="delete-cookie-btn" class="btn-danger" style="display: none;">
                            <i class="bi bi-trash"></i> X√≥a Cookie
                        </button>
                    </div>
                    <div class="cookie-help">
                        <i class="bi bi-question-circle"></i>
                        <small>Upload cookie t·ª´ tr√¨nh duy·ªát ƒë·ªÉ tr√°nh b·ªã YouTube ch·∫∑n. S·ª≠ d·ª•ng extension nh∆∞ "Get cookies.txt" ƒë·ªÉ export cookie.</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="youtube-import-actions">
            <button type="button" class="btn-secondary" id="youtube-cancel-btn">H·ªßy</button>
            <button type="button" class="btn-primary" id="youtube-preview-btn">
                <i class="bi bi-eye"></i>
                Xem Tr∆∞·ªõc
            </button>
            <button type="button" class="btn-success" id="youtube-import-start-btn">
                <i class="bi bi-download"></i>
                Import Ngay
            </button>
        </div>
        
        <div class="import-hint">
            <i class="bi bi-lightbulb"></i>
            <small>
                <strong>M·∫πo:</strong> N√∫t "Import Ngay" s·∫Ω t·ª± ƒë·ªông l·∫•y th√¥ng tin v√† import lu√¥n. 
                N√∫t "Xem Tr∆∞·ªõc" ch·ªâ ƒë·ªÉ ki·ªÉm tra th√¥ng tin tr∆∞·ªõc khi import.
            </small>
        </div>
    </div>
</div>

<script src="{% static 'music_player/js/youtube_import.js' %}?v=4.5.0"></script>
<link rel="stylesheet" href="{% static 'music_player/css/youtube_preview.css' %}?v=1.7.0">

