{% extends 'base.html' %}
{% load static %}

{% block title %}Nhập tên cầu thủ{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-sm">
                <div class="card-header bg-primary text-white text-center">
                    <h4 class="mb-0">
                        <i class="bi bi-person-plus-fill me-2"></i>
                        Nhập tên cầu thủ
                    </h4>
                </div>
                <div class="card-body p-4">
                    <!-- Progress indicator -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="progress" style="height: 8px;">
                                <div class="progress-bar bg-primary" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="d-flex justify-content-between mt-2">
                                <small class="text-muted">Bước 1: Chọn vai trò</small>
                                <small class="text-primary fw-bold">Bước 2: Nhập tên cầu thủ</small>
                                <small class="text-muted">Bước 3: Xác nhận</small>
                            </div>
                        </div>
                    </div>

                    {% if messages %}
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                                <i class="bi bi-info-circle me-2"></i>
                                {{ message }}
                                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                            </div>
                        {% endfor %}
                    {% endif %}

                    {% if has_existing_profile %}
                    <div class="alert alert-warning">
                        <h6 class="alert-heading">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            Bạn đã có hồ sơ cầu thủ
                        </h6>
                        <p class="mb-2">Bạn đã có hồ sơ cầu thủ hiện tại. Bạn có thể:</p>
                        <ul class="mb-0">
                            <li><strong>Liên kết với cầu thủ khác:</strong> Hủy liên kết hiện tại và liên kết với cầu thủ mới</li>
                            <li><strong>Tạo cầu thủ tự do mới:</strong> Tạo hồ sơ cầu thủ tự do riêng biệt</li>
                        </ul>
                    </div>
                    {% endif %}

                    <div class="alert alert-info">
                        <h6 class="alert-heading">
                            <i class="bi bi-info-circle me-2"></i>
                            Hướng dẫn chi tiết
                        </h6>
                        <p class="mb-2">Nhập tên cầu thủ mà bạn muốn sử dụng. Hệ thống sẽ kiểm tra và đưa ra các lựa chọn phù hợp:</p>
                        <ul class="mb-0">
                            <li><strong>Nếu tìm thấy cầu thủ trùng tên:</strong> Bạn có thể liên kết với cầu thủ đó hoặc tạo mới</li>
                            <li><strong>Nếu không tìm thấy:</strong> Hệ thống sẽ tạo hồ sơ cầu thủ tự do mới cho bạn</li>
                        </ul>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="card border-light h-100">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">
                                        <i class="bi bi-person-circle me-2"></i>
                                        Thông tin tài khoản
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><strong>Tên hiển thị:</strong> {{ user_name }}</li>
                                        <li><strong>Email:</strong> {{ user_email }}</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card border-success h-100">
                                <div class="card-header bg-success text-white">
                                    <h6 class="mb-0">
                                        <i class="bi bi-lightbulb me-2"></i>
                                        Mẹo và lưu ý
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <ul class="list-unstyled">
                                        <li><i class="bi bi-check-circle text-success me-2"></i><strong>Nhập tên thật:</strong> Sử dụng tên thật để dễ nhận diện</li>
                                        <li><i class="bi bi-check-circle text-success me-2"></i><strong>Có thể trùng tên:</strong> Không sao nếu trùng với cầu thủ khác</li>
                                        <li><i class="bi bi-check-circle text-success me-2"></i><strong>Kiểm tra tự động:</strong> Hệ thống sẽ tìm kiếm thông minh</li>
                                        <li><i class="bi bi-check-circle text-success me-2"></i><strong>Có thể quay lại:</strong> Bạn có thể sửa đổi sau này</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <form method="post" class="mt-4">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="player_name" class="form-label">
                                <strong>Tên cầu thủ *</strong>
                            </label>
                            <input type="text" 
                                   class="form-control form-control-lg" 
                                   id="player_name" 
                                   name="player_name" 
                                   placeholder="Ví dụ: Nguyễn Văn A, Trần Thị B..."
                                   required>
                            <div class="form-text">
                                <i class="bi bi-info-circle me-1"></i>
                                Tên này sẽ được hiển thị trong hồ sơ cầu thủ của bạn và có thể được các đội khác tìm thấy.
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <a href="{% url 'select_roles' %}" class="btn btn-outline-secondary btn-lg w-100">
                                    <i class="bi bi-arrow-left me-2"></i>
                                    Quay lại bước trước
                                </a>
                            </div>
                            <div class="col-md-6">
                                <button type="submit" class="btn btn-primary btn-lg w-100">
                                    <i class="bi bi-search me-2"></i>
                                    Kiểm tra và tiếp tục
                                </button>
                            </div>
                        </div>
                    </form>

                    <!-- FAQ Section -->
                    <div class="mt-4">
                        <div class="card border-light">
                            <div class="card-header bg-light">
                                <h6 class="mb-0">
                                    <i class="bi bi-question-circle me-2"></i>
                                    Câu hỏi thường gặp
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="accordion" id="faqAccordion">
                                    <div class="accordion-item">
                                        <h2 class="accordion-header" id="faq1">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
                                                Tôi có thể thay đổi tên sau này không?
                                            </button>
                                        </h2>
                                        <div id="collapse1" class="accordion-collapse collapse" aria-labelledby="faq1" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Có, bạn có thể chỉnh sửa thông tin cầu thủ sau khi tạo hồ sơ. Tuy nhiên, số lần chỉnh sửa có giới hạn để đảm bảo tính nhất quán.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="accordion-item">
                                        <h2 class="accordion-header" id="faq2">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                                                Điều gì xảy ra nếu tên của tôi trùng với cầu thủ khác?
                                            </button>
                                        </h2>
                                        <div id="collapse2" class="accordion-collapse collapse" aria-labelledby="faq2" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Không sao cả! Hệ thống sẽ kiểm tra và đưa ra các lựa chọn phù hợp. Bạn có thể liên kết với cầu thủ đã có hoặc tạo hồ sơ mới.
                                            </div>
                                        </div>
                                    </div>
                                    <div class="accordion-item">
                                        <h2 class="accordion-header" id="faq3">
                                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
                                                Tôi có thể bỏ qua bước này không?
                                            </button>
                                        </h2>
                                        <div id="collapse3" class="accordion-collapse collapse" aria-labelledby="faq3" data-bs-parent="#faqAccordion">
                                            <div class="accordion-body">
                                                Không, đây là bước bắt buộc để tạo hồ sơ cầu thủ. Bạn có thể quay lại bước trước để thay đổi vai trò nếu muốn.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    transition: transform 0.2s ease-in-out;
}

.card:hover {
    transform: translateY(-2px);
}

.form-control:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
}

.btn {
    transition: all 0.2s ease-in-out;
}

.btn:hover {
    transform: translateY(-1px);
}
</style>
{% endblock %}
